# 游戏页面复刻指南

## 功能说明

现在项目支持复刻单个游戏页面，实现方式与首页相同：
- 使用 Next.js 动态路由 `app/g/[slug]/`
- layout.tsx 注入游戏页面的 head
- page.tsx 渲染游戏页面的 body

## 复刻单个游戏页面

### 1. 下载游戏页面

```bash
node scripts/fetchGamePage.js <游戏slug>
```

例如：
```bash
node scripts/fetchGamePage.js 18-wheeler-accident-lawyer-atlanta
```

这个脚本会：
- 下载 `https://poki.ee/g/<slug>` 的完整 HTML
- 提取 head 和 body 内容
- 自动替换链接（poki.ee -> 本地路由）
- 保存到 `data/games/<slug>/` 目录

### 2. 访问游戏页面

启动开发服务器后，访问：
```
http://localhost:3000/g/<slug>
```

例如：
```
http://localhost:3000/g/18-wheeler-accident-lawyer-atlanta
```

## 首页链接已自动替换

运行 `node scripts/replaceLinks.js` 后，首页的所有链接已替换为本地路由：
- `https://poki.ee/g/xxx` → `/g/xxx`
- `https://poki.ee/category` → `/category`

点击首页的游戏卡片会跳转到本地游戏页面。

## 批量复刻多个游戏

如果需要复刻多个游戏，可以创建一个批处理脚本：

```bash
# 创建 fetch-games.ps1
$games = @(
    "18-wheeler-accident-lawyer-atlanta",
    "plonky",
    "tung-sahur-clicker"
)

foreach ($game in $games) {
    Write-Host "正在下载: $game" -ForegroundColor Green
    node scripts/fetchGamePage.js $game
}
```

## 文件结构

```
data/
├── home-head.html          # 首页 head
├── home-body.html          # 首页 body
└── games/
    └── <slug>/
        ├── original.html   # 完整 HTML
        ├── head.html       # head 内容
        └── body.html       # body 内容（已替换链接）
```

## 注意事项

1. **游戏页面未找到**：如果访问游戏页面显示"游戏页面未找到"，说明还没有下载该游戏，需要先运行 `fetchGamePage.js`

2. **链接替换**：`fetchGamePage.js` 会自动将游戏页面中的 poki.ee 链接替换为本地路由

3. **资源加载**：游戏页面中的图片、CSS、JS 等外部资源仍然从原网站加载

4. **动态内容**：某些游戏可能依赖 JavaScript 动态加载内容，这些内容会正常工作

## 示例：完整流程

```bash
# 1. 下载首页内容（如果还没有）
node scripts/fetchSite.js

# 2. 替换首页链接为本地路由
node scripts/replaceLinks.js

# 3. 下载游戏页面
node scripts/fetchGamePage.js 18-wheeler-accident-lawyer-atlanta

# 4. 启动开发服务器
npm run dev

# 5. 访问
# 首页: http://localhost:3000
# 游戏: http://localhost:3000/g/18-wheeler-accident-lawyer-atlanta
```

## 更新游戏页面

如果原网站的游戏页面更新了，重新运行：
```bash
node scripts/fetchGamePage.js <slug>
```

会覆盖旧的内容。
